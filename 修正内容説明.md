# dinner-board2 修正版

## 📝 修正内容（2025年11月7日）

このバージョンでは、以下の3つの問題を修正しました：

---

### ✅ 1. settings.htmlの文字化け修正

**問題点：**
- 日本語が文字化けして表示されていた（例：`æœ¬æ—¥ã®è¨­å®š` → `本日の設定`）

**修正内容：**
- HTMLのcharset指定を明確に`UTF-8`に設定
- すべての文字化けした日本語を正しい表記に修正
- 見出し、ラベル、プレースホルダーなどすべての日本語テキストを修正

**修正箇所：**
- `<meta charset="UTF-8">` を明確に指定
- すべての日本語テキストを正しく表記

---

### ✅ 2. 保存ボタンの整理・統一

**問題点：**
- settings.htmlに保存ボタンが2つあり、役割が不明確だった
- `save-btn`と`save-next-btn`が混在していた
- `to-board-btn`が無効化されていて使えなかった

**修正内容：**
- 2つのボタンに整理・統一
  1. **「保存して発注ボードへ」ボタン（青）**
     - 設定を保存して、すぐに発注ボード（index.html）へ移動
     - 保存後に自動的に画面遷移するので、すぐに使える
  
  2. **「保存のみ」ボタン（グレー）**
     - 設定を保存するだけで、画面は移動しない
     - 入力途中で一時保存したい時に便利

**修正箇所：**
- `save-and-board-btn`（保存して発注ボードへ）
- `save-only-btn`（保存のみ）
- 不要なボタンを削除し、機能を明確化

**追加機能：**
- 前回保存した設定を自動的に読み込んで表示
- カスタム部屋の人数入力も正しく復元されるように改善

---

### ✅ 3. リセット機能の確認と改善

**問題点：**
- リセットボタンを押しても、画面が正しく更新されない場合があった
- リセット後のメッセージが不明確だった

**修正内容：**
- リセット機能を確実に動作するように改善
- リセット後に画面を自動的に再描画
- わかりやすい確認メッセージとリセット完了メッセージを追加
- 古い形式のデータも同時に削除するように改善

**修正箇所：**
- `app.js`の`resetBoardStatesToPendingV3()`関数
- リセットボタンのイベントリスナー
- リセット後の画面再描画処理

**動作：**
1. 「本日データを初期化」ボタンをクリック
2. 確認ダイアログが表示される
3. OKを押すと、すべての丸ボタンが「未」に戻る
4. 画面が自動的に再描画される
5. 完了メッセージが表示される

---

## 🚀 使い方

### ファイルの配置
以下のファイルをすべて同じフォルダに配置してください：
- `index.html`（発注ボード画面）
- `settings.html`（設定画面）
- `app.js`（メインプログラム）
- `style.css`（スタイルシート）

### 使用手順
1. `settings.html`を開く
2. チェックボックスで使用する部屋を選択
3. 人数、プラン、夕食開始時間などを入力
4. 「保存して発注ボードへ」をクリック
5. 発注ボード画面で丸ボタンをクリックして状態を管理

### 状態の遷移
丸ボタンをクリックするたびに状態が変わります：
```
未 → 準備 → 発注 → 提供 → 未 → ...
```

### リセット方法
1. 発注ボード画面で「本日データを初期化」ボタンをクリック
2. 確認ダイアログで「OK」を押す
3. すべての丸ボタンが「未」に戻ります

---

## 📦 ファイル一覧

- `index.html` - 発注ボード画面（タブ切替機能付き）
- `settings.html` - 設定画面（修正版）
- `app.js` - メインJavaScriptファイル（修正版）
- `style.css` - スタイルシート
- `README.md` - このファイル

---

## 💾 データ保存について

このアプリは、ブラウザの`localStorage`にデータを保存します：

- `today-settings.v1` - 本日の設定（部屋情報など）
- `dinner.board.v3` - 丸ボタンの状態

※ ブラウザのキャッシュをクリアすると、保存したデータが消えます。

---

## ⚠️ 注意事項

1. **文字コードについて**
   - すべてのHTMLファイルは`UTF-8`で保存してください
   - VSCodeで保存する際は、右下の文字コード表示が「UTF-8」になっていることを確認してください

2. **ブラウザについて**
   - モダンなブラウザ（Chrome、Firefox、Edge、Safari）で動作します
   - Internet Explorerでは動作しません

3. **データのバックアップ**
   - 重要なデータは定期的にバックアップしてください
   - ブラウザのキャッシュクリアやプライベートモードでは保存されません

---

## 🔄 今後の改善予定

- キッチン表示画面の実装
- 印刷機能の追加
- データのエクスポート/インポート機能
- スマホ対応の改善
- 音声通知機能

---

## 📞 サポート

質問や問題がある場合は、開発者に連絡してください。

**作成日：** 2025年11月7日  
**バージョン：** 1.1（修正版）
